# üó∫Ô∏è Project Roadmap: CineSync (Microservices Architecture)

## 1. –ö–æ–Ω—Ü–µ–ø—Ü–∏—è –∏ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
–ú—ã —Å—Ç—Ä–æ–∏–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É. –≠—Ç–æ —Å–ª–æ–∂–Ω–µ–µ –º–æ–Ω–æ–ª–∏—Ç–∞, –Ω–æ –¥–∞–µ—Ç –≥–∏–±–∫–æ—Å—Ç—å –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å.

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã (The "Commercial Way"):
1.  **Database per Service:** –£ –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ —Å–≤–æ—è –ë–î. –ù–∏–∫–∞–∫–∏—Ö –æ–±—â–∏—Ö –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö (–∞–Ω—Ç–∏–ø–∞—Ç—Ç–µ—Ä–Ω).
2.  **API Gateway:** –ö–ª–∏–µ–Ω—Ç (Frontend/Mobile) –æ–±—â–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —Å –æ–¥–Ω–∏–º —à–ª—é–∑–æ–º, –∞ –Ω–µ —Å —Å–µ—Ä–≤–∏—Å–∞–º–∏ –Ω–∞–ø—Ä—è–º—É—é.
3.  **Asynchronous Communication:** –°–µ—Ä–≤–∏—Å—ã –æ–±—â–∞—é—Ç—Å—è –Ω–µ —Ç–æ–ª—å–∫–æ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ (HTTP), –Ω–æ –∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ —á–µ—Ä–µ–∑ –±—Ä–æ–∫–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π (RabbitMQ) –¥–ª—è —É–º–µ–Ω—å—à–µ–Ω–∏—è —Å–≤—è–∑–Ω–æ—Å—Ç–∏.
4.  **Infrastructure as Code:** –í—Å—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (–ë–î, –ö—ç—à, –ë—Ä–æ–∫–µ—Ä) –ø–æ–¥–Ω–∏–º–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ Docker Compose.

---

## 2. –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –°—Ç–µ–∫ (Industry Standard 2025)

*   **–Ø–∑—ã–∫:** Python 3.12 (Golden Standard).
*   **–§—Ä–µ–π–º–≤–æ—Ä–∫:** FastAPI (Async).
*   **–ú–µ–Ω–µ–¥–∂–µ—Ä –ø–∞–∫–µ—Ç–æ–≤:** Poetry (—Å –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π `in-project`).
*   **–ë–∞–∑—ã –î–∞–Ω–Ω—ã—Ö:**
    *   **PostgreSQL 16** (–æ—Å–Ω–æ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ).
    *   **Redis 7** (–∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Å–µ—Å—Å–∏–∏).
*   **ORM:** SQLAlchemy 2.0 (—Å—Ç—Ä–æ–≥–æ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è) + Alembic.
*   **–ë—Ä–æ–∫–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π:** RabbitMQ (–¥–ª—è —Ñ–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á).
*   **–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞:** Docker, Docker Compose, Nginx (–∫–∞–∫ Gateway).
*   **–ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞:** Ruff (–ª–∏–Ω—Ç–µ—Ä), Pytest (—Ç–µ—Å—Ç—ã).
*   **Observability (–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥):** Jaeger (–¥–ª—è —Ç—Ä–µ–π—Å–∏–Ω–≥–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏ ‚Äî —ç—Ç–æ "–≤—ã—Å—à–∏–π –ø–∏–ª–æ—Ç–∞–∂").

---

## 3. –≠—Ç–∞–ø—ã –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (Step-by-Step)

### üü¢ –≠–¢–ê–ü 0: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ (Infrastructure & Setup)
*–¶–µ–ª—å: –°–æ–∑–¥–∞—Ç—å –∏–¥–µ–∞–ª—å–Ω—É—é —Å—Ä–µ–¥—É, —á—Ç–æ–±—ã –±–æ–ª—å—à–µ –Ω–µ –±–æ—Ä–æ—Ç—å—Å—è —Å –ø—É—Ç—è–º–∏ –∏ –≤–µ—Ä—Å–∏—è–º–∏.*

1.  **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ IDE –∏ Git:**
    *   –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π `.gitignore`.
    *   –ù–∞—Å—Ç—Ä–æ–π–∫–∞ PyCharm –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Poetry.
    *   –ì–ª–æ–±–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Poetry: `virtualenvs.in-project = true`.
2.  **Docker Network:**
    *   –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑–æ–≤–æ–≥–æ `docker-compose.yml` —Ç–æ–ª—å–∫–æ —Å –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π (Postgres, Redis, RabbitMQ, Jaeger).
    *   –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –≤–∏–¥—è—Ç –¥—Ä—É–≥ –¥—Ä—É–≥–∞.

---

### üü¢ –≠–¢–ê–ü 1: Service "Movie Catalog" (Read-Heavy Service)
*–¶–µ–ª—å: –°–µ—Ä–≤–∏—Å –ø–æ–∏—Å–∫–∞ —Ñ–∏–ª—å–º–æ–≤. –î–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—á–µ–Ω—å –±—ã—Å—Ç—Ä—ã–º –∏ –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤—ã–º.*

1.  **Core:**
    *   –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å **TMDB API** —á–µ—Ä–µ–∑ `httpx`.
    *   –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞—Ç—Ç–µ—Ä–Ω–∞ **Circuit Breaker** (–µ—Å–ª–∏ TMDB —É–ø–∞–ª, –Ω–∞—à —Å–µ—Ä–≤–∏—Å –Ω–µ –≤–∏—Å–Ω–µ—Ç, –∞ –æ—Ç–¥–∞–µ—Ç –æ—à–∏–±–∫—É —Å—Ä–∞–∑—É).
2.  **Caching Layer:**
    *   –í–Ω–µ–¥—Ä–µ–Ω–∏–µ Redis.
    *   –õ–æ–≥–∏–∫–∞ "Cache-Aside": –∏—â–µ–º –≤ –∫—ç—à–µ -> –µ—Å–ª–∏ –Ω–µ—Ç, –∏—â–µ–º –≤ API -> —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –∫—ç—à.
3.  **API:**
    *   –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã `/movies/search`, `/movies/{id}`.
    *   Pydantic v2 —Å—Ö–µ–º—ã (—Å—Ç—Ä–æ–≥–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–æ–≤).

---

### üü¢ –≠–¢–ê–ü 2: Service "Identity & User" (Security Core)
*–¶–µ–ª—å: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é. –°–∞–º—ã–π –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π –º–æ–¥—É–ª—å.*

1.  **Database Design:**
    *   –¢–∞–±–ª–∏—Ü–∞ `users` (email, hashed_password, role, is_active).
    *   –ú–∏–≥—Ä–∞—Ü–∏–∏ Alembic (Async).
2.  **Auth Logic:**
    *   –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è + –í–∞–ª–∏–¥–∞—Ü–∏—è Email (Pydantic EmailStr).
    *   –í—Ö–æ–¥ (Login) -> –í—ã–¥–∞—á–∞ –ø–∞—Ä—ã —Ç–æ–∫–µ–Ω–æ–≤ **JWT** (Access + Refresh).
    *   –õ–æ–≥–∏–∫–∞ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –ø–∞—Ä–æ–ª–µ–π (Bcrypt).
3.  **API:**
    *   –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã `/auth/register`, `/auth/login`, `/users/me`.

---

### üü¢ –≠–¢–ê–ü 3: API Gateway (–¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞)
*–¶–µ–ª—å: –°–∫—Ä—ã—Ç—å –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã –æ—Ç –≤–Ω–µ—à–Ω–µ–≥–æ –º–∏—Ä–∞.*

1.  **Routing:**
    *   –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Nginx (–∏–ª–∏ Python-based Gateway), –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç:
        *   `/api/v1/movies/*` -> `movie_service`
        *   `/api/v1/auth/*` -> `user_service`
2.  **Auth Middleware:**
    *   –ü—Ä–æ–≤–µ—Ä–∫–∞ JWT —Ç–æ–∫–µ–Ω–∞ –Ω–∞ —É—Ä–æ–≤–Ω–µ Gateway (–∏–ª–∏ –≤ –∫–∞–∂–¥–æ–º —Å–µ—Ä–≤–∏—Å–µ ‚Äî —Ä–µ—à–∏–º –ø–æ —Ö–æ–¥—É, –¥–ª—è –Ω–∞—á–∞–ª–∞ —Å–¥–µ–ª–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É –≤ —Å–µ—Ä–≤–∏—Å–∞—Ö).

---

### üü° –≠–¢–ê–ü 4: Business Logic "User Library" (–°–≤—è–∑—å —Å–µ—Ä–≤–∏—Å–æ–≤)
*–¶–µ–ª—å: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–±–∞–≤–ª—è–µ—Ç —Ñ–∏–ª—å–º—ã –≤ "–ò–∑–±—Ä–∞–Ω–Ω–æ–µ". –ó–¥–µ—Å—å —Å–µ—Ä–≤–∏—Å—ã –Ω–∞—á–∏–Ω–∞—é—Ç "–¥—Ä—É–∂–∏—Ç—å".*

1.  **Service Expansion (User Service):**
    *   –ù–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ `favorites` (user_id, movie_id, movie_title...).
    *   *–ü—Ä–æ–±–ª–µ–º–∞:* User Service –Ω–µ –∑–Ω–∞–µ—Ç –ø—Ä–æ —Ñ–∏–ª—å–º—ã. –û–Ω –∑–Ω–∞–µ—Ç —Ç–æ–ª—å–∫–æ ID.
    *   *–†–µ—à–µ–Ω–∏–µ:* –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ User Service –¥–µ–ª–∞–µ—Ç **—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å** –≤ Movie Service, —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ñ–∏–ª—å–º–∞ –∏ –∑–∞–±—Ä–∞—Ç—å –µ–≥–æ –Ω–∞–∑–≤–∞–Ω–∏–µ.
2.  **API:**
    *   `POST /users/me/favorites` ‚Äî –¥–æ–±–∞–≤–∏—Ç—å.
    *   `GET /users/me/favorites` ‚Äî –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫.

---

### üü° –≠–¢–ê–ü 5: Async Events (RabbitMQ)
*–¶–µ–ª—å: –î–µ–ª–∞–µ–º —Å–∏—Å—Ç–µ–º—É "–∂–∏–≤–æ–π" –∏ –Ω–µ–±–ª–æ–∫–∏—Ä—É—é—â–µ–π.*

1.  **–°—Ü–µ–Ω–∞—Ä–∏–π:** –ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è, –º—ã —Ö–æ—Ç–∏–º –æ—Ç–ø—Ä–∞–≤–∏—Ç—å "–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π Email" (–∏–ª–∏ –ª–æ–≥). –ú—ã –Ω–µ —Ö–æ—Ç–∏–º –∂–¥–∞—Ç—å –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–∏—Å—å–º–∞, —á—Ç–æ–±—ã –≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç "200 OK".
2.  **Implementation:**
    *   User Service –∫–∏–¥–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ `UserCreated` –≤ RabbitMQ.
    *   –ù–æ–≤—ã–π –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å **Notification Service** —Å–ª—É—à–∞–µ—Ç –æ—á–µ—Ä–µ–¥—å –∏ (–≤ —Ç–µ–æ—Ä–∏–∏) —à–ª–µ—Ç email / –ø–∏—à–µ—Ç –≤ –∫–æ–Ω—Å–æ–ª—å.

---

### üî¥ –≠–¢–ê–ü 6 (Advanced): Observability & Production Ready
*–¶–µ–ª—å: –ü–æ–Ω—è—Ç—å, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤–Ω—É—Ç—Ä–∏.*

1.  **Logging:** –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (JSON logs) –≤–æ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–∞—Ö.
2.  **Tracing:** –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ **OpenTelemetry**. –¢—ã —Å–º–æ–∂–µ—à—å –≤–∏–¥–µ—Ç—å –∫—Ä–∞—Å–∏–≤—ã–π –≥—Ä–∞—Ñ–∏–∫:
    *   Request Gateway (10ms) -> Auth Check (5ms) -> Movie Search (Redis miss) -> TMDB API (200ms) -> Response.

---

## 4. –ò—Ç–æ–≥–æ–≤–∞—è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (–°—Ö–µ–º–∞)

```text
[CLIENT (Browser/Postman)]
       |
       v
[ API GATEWAY (Nginx/FastAPI) ]
       |
       +-------------------------+------------------------+
       |                         |                        |
       v                         v                        v
[ USER SERVICE ] <-----> [ MOVIE SERVICE ]          [ NOTIFICATION SERVICE ]
(PostgreSQL)             (Redis + TMDB API)         (Consumes RabbitMQ)
       |                         ^
       |                         |
       +----(Event: UserCreated)-+
                 |
         [ RabbitMQ ]
```
